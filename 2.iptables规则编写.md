### iptables/netfilter

- 规则：

  - 组成部分：根据规则匹配条件来尝试匹配报文，一旦匹配成功，就由规则定义的处理动作作出处理。
    - 匹配条件：
      - 基本匹配条件。
      - 扩展匹配条件。
    - 处理动作：
      - 基本处理动作。
      - 扩展处理动作。
      - 自定义处理机制。
  - iptables的链：内置链和自定义链
    - 内置链：对应于hook function。
    - 自定义链：用于内置链的扩展和补充，可实现更灵活的规则管理机制。

- 添加规则时的考量点：

  1. 要实现哪种功能：判断添加到哪个表上；
  2. 报文流经的路径：判断添加到哪个链上；

  - 链：链上的规则次序，即为检查次序；因此，隐含一定的应用法则：
    1. 同类规则（访问同一应用），匹配范围小的放上面。
    2. 不同类规则（访问不同应用），匹配到报文频率较大的放在上面。
    3. 将那些可由一条规则描述的多个规则合并起来。
    4. 设置默认策略。